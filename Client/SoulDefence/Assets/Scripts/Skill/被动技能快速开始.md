# 被动技能快速开始指南

## 快速配置

### 1. 创建带被动效果的技能

在 Unity 编辑器中：
1. 右键 -> Create -> GameConfig -> Skill
2. 配置基础信息
3. 配置主动技能（如果需要）
4. 展开"被动技能配置"

### 2. 常用被动技能配置模板

#### 模板1：每N次攻击强化

```
场景：每攻击2次，第3次造成双倍伤害

被动技能配置：
✅ enabled: true
  passiveName: "三连击"
  
  触发条件：
    triggerType: OnAttackCount
    attackCountThreshold: 3
  
  效果配置：
    effectType: DamageMultiplier
    damageMultiplier: 2.0
```

#### 模板2：增加战斗属性

```
场景：永久增加攻击力

被动技能配置：
✅ enabled: true
  passiveName: "力量增幅"
  
  触发条件：
    triggerType: None  (永久)
  
  效果配置：
    effectType: AttributeBonus
    attributeType: 0  (攻击力)
    attributeBonusValue: 15
```

#### 模板3：定时回血

```
场景：每5秒恢复20点生命

被动技能配置：
✅ enabled: true
  passiveName: "生命再生"
  
  触发条件：
    triggerType: Interval
    intervalTime: 5
  
  效果配置：
    effectType: HealthRegen
    healAmount: 20
```

#### 模板4：攻击附加伤害

```
场景：每次攻击额外造成10点伤害

被动技能配置：
✅ enabled: true
  passiveName: "锋利"
  
  触发条件：
    triggerType: OnAttack
  
  效果配置：
    effectType: ExtraDamage
    extraDamage: 10
```

#### 模板5：受击伤害减免

```
场景：受到攻击时减免30%伤害

被动技能配置：
✅ enabled: true
  passiveName: "护甲强化"
  
  触发条件：
    triggerType: OnHit
  
  效果配置：
    effectType: DamageReduction
    damageReductionPercent: 0.3
    
  冷却配置：
  ✅ hasCooldown: true
    cooldownTime: 5
```

#### 模板6：生命值低时触发

```
场景：生命值低于30%时获得护盾

被动技能配置：
✅ enabled: true
  passiveName: "求生意志"
  
  触发条件：
    triggerType: OnHealthLow
    healthThreshold: 30
  
  效果配置：
    effectType: Shield
    shieldAmount: 100
    
  冷却配置：
  ✅ hasCooldown: true
    cooldownTime: 60
```

#### 模板7：击杀回血

```
场景：击杀敌人恢复50点生命

被动技能配置：
✅ enabled: true
  passiveName: "吸血"
  
  触发条件：
    triggerType: OnKill
  
  效果配置：
    effectType: HealthRegen
    healAmount: 50
```

## 三种技能类型

### 纯主动技能（默认）
```
主动技能参数：
✅ hasActiveSkill: true
  damage: 50
  cooldown: 3

被动技能配置：
❌ enabled: false  (不启用)
```

### 纯被动技能
```
主动技能参数：
❌ hasActiveSkill: false  (关闭主动)

被动技能配置：
✅ enabled: true
  ...被动配置
```

### 主动+被动技能
```
主动技能参数：
✅ hasActiveSkill: true
  damage: 50
  cooldown: 3

被动技能配置：
✅ enabled: true
  ...被动配置
```

## 参数说明速查

### 触发类型 (triggerType)

| 值 | 说明 | 需要配置的参数 |
|----|------|---------------|
| None | 永久生效 | - |
| OnAttack | 攻击时 | - |
| OnHit | 受击时 | - |
| OnKill | 击杀时 | - |
| Interval | 定时触发 | intervalTime |
| OnHealthLow | 生命值低 | healthThreshold |
| OnAttackCount | 攻击次数 | attackCountThreshold |

### 效果类型 (effectType)

| 值 | 说明 | 需要配置的参数 |
|----|------|---------------|
| AttributeBonus | 属性加成 | attributeType, attributeBonusValue |
| DamageMultiplier | 伤害倍率 | damageMultiplier |
| ExtraDamage | 额外伤害 | extraDamage |
| CriticalHit | 暴击 | criticalMultiplier |
| DamageReduction | 伤害减免 | damageReductionPercent |
| Shield | 护盾 | shieldAmount |
| HealthRegen | 生命恢复 | healAmount |

### 属性类型 (attributeType)

- 0 = 攻击力
- 1 = 防御力
- 2 = 攻击速度
- 3 = 移动速度

## 调试技巧

### 检查被动技能是否生效

```csharp
// 获取被动技能数量
int count = entity.SkillSystem.PassiveSkillSystem.GetPassiveSkillCount();
Debug.Log($"被动技能数量: {count}");

// 手动触发攻击事件（测试）
entity.SkillSystem.PassiveSkillSystem.OnAttack();

// 获取伤害修正（测试）
float modifier = entity.SkillSystem.GetPassiveDamageModifier(100f);
Debug.Log($"伤害修正: +{modifier}");
```

### 常见问题

**Q: 被动技能没有触发？**
- 检查 `enabled` 是否勾选
- 检查触发条件是否满足
- 检查是否在冷却中
- 查看控制台日志

**Q: 属性加成不生效？**
- 永久属性加成需要触发条件为 `None`
- 效果类型必须是 `AttributeBonus`
- 目前属性加成需要属性系统支持（可能需要额外实现）

**Q: 如何实现复杂被动？**
- 使用多个技能，每个技能一个被动
- 或者使用 `Custom` 效果类型自定义实现

**Q: 护盾效果不生效？**
- 护盾系统需要单独实现
- 目前只是记录日志

## 配置检查清单

创建被动技能时，检查：
- ✅ 勾选 `enabled`
- ✅ 填写 `passiveName` 和 `description`
- ✅ 选择正确的 `triggerType`
- ✅ 配置触发类型对应的参数
- ✅ 选择正确的 `effectType`
- ✅ 配置效果类型对应的参数
- ✅ 如需冷却，勾选 `hasCooldown` 并设置时间

## 测试流程

1. **创建测试技能**
   - 使用简单的攻击触发
   - 额外伤害效果
   - 无冷却

2. **配置到实体**
   - 将技能添加到实体的技能列表
   - 运行游戏

3. **观察日志**
   - 查看"[被动技能]"相关日志
   - 确认触发和效果应用

4. **逐步复杂化**
   - 测试通过后再配置复杂的被动技能

## 推荐配置组合

### 战士职业

```
技能1：普通攻击 (主动)
  + 被动：每3次攻击，下次造成150%伤害

技能2：旋风斩 (主动近战AOE)
  + 被动：永久增加攻击力 +10

技能3：铁壁 (纯被动)
  - 受击时减免20%伤害（冷却10秒）
```

### 弓手职业

```
技能1：普通射击 (主动)
  + 被动：攻击附加5点额外伤害

技能2：多重箭 (主动远程)
  + 被动：击杀敌人恢复30点生命

技能3：敏捷 (纯被动)
  - 永久增加移动速度 +2
```

### 法师职业

```
技能1：火球术 (主动)
  + 被动：每次攻击造成1.2倍伤害

技能2：法力护盾 (纯被动)
  - 生命值低于30%获得100点护盾（冷却60秒）

技能3：法力恢复 (纯被动)
  - 每5秒恢复20点生命
```

## 下一步

配置完成后：
1. 测试被动技能触发
2. 调整数值平衡
3. 添加更多被动技能
4. 组合不同被动效果
5. 根据游戏体验优化

