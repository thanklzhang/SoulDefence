
# 技能系统设计

## 设计原则
- 简洁：一个统一的技能基类
- 通用：所有技能类型都基于同一个框架
- 可扩展：通过配置和组合实现复杂技能

## 技能分类

### 1. 按释放类型
- **主动技能**：需要手动/AI触发（普通攻击、小招、大招、滑行）
- **被动技能**：满足条件自动触发（如第3次攻击、受击时）

### 2. 按效果类型
- **伤害技能**：直接造成伤害
- **状态技能**：添加Buff/Debuff（增益/减益）
- **移动技能**：改变位置（冲刺、滑行）
- **复合技能**：组合多种效果

## 核心结构

### 技能配置 (SkillConfig)
```
技能ID
技能名称
技能类型：主动/被动
触发方式：按键/自动/条件触发
冷却时间
释放前摇/后摇
```

### 技能执行流程
```
1. 检查条件（冷却、资源、状态）
2. 执行前摇动画
3. 判定目标（范围检测）
4. 应用效果（伤害/状态/移动）
5. 执行后摇动画
6. 进入冷却
```

## 技能效果类型

### 1. 伤害效果
```
类型：近战/远程/投射物
范围：单体/扇形/圆形/全屏
伤害值：基础值 + 属性加成
目标数量：1~无限
特殊效果：击退/吸血/穿透
```

### 2. 状态效果（Buff系统）
```
状态类型：增益/减益
持续时间
效果内容：属性修改/特殊机制
叠加规则：可叠加/刷新/独立
```

### 3. 移动效果
```
移动类型：直线冲刺/传送/击退
移动距离
移动速度
碰撞处理：穿透/停止
```

## 实体设计中的技能映射

### 英雄技能
1. **普通攻击（伤害+范围）**
   - 类型：主动-近战
   - 范围：前方扇形
   - 目标：多个敌人
   
2. **小招-躲避反击（状态+条件伤害）**
   - 类型：主动-状态技能
   - 效果1：添加"躲避"状态（1.5秒）
   - 效果2：躲避成功时触发周围范围伤害
   
3. **大招-战吼（多重状态）**
   - 类型：主动-状态技能
   - 效果1：增加护甲（Buff）
   - 效果2：增加攻击力（Buff）
   - 效果3：普攻吸血20%（Buff）
   - 持续时间：X秒
   
4. **被动-第三击（条件触发）**
   - 类型：被动技能
   - 触发条件：每第3次普通攻击
   - 效果1：伤害增强
   - 效果2：回复生命值（攻击力2%）
   
5. **滑行（移动）**
   - 类型：主动-移动技能
   - 效果：向前方快速移动一段距离

### Boss技能
1. **普通攻击**：单体近战
2. **小招-冲刺**：移动技能（瞬间接近目标）
3. **大招-减速光环**：范围伤害+减速Debuff
4. **被动-攻速叠加**：每次命中增加攻速（最多5层）

### 怪物技能
1. **普通攻击**：单体近战（最简单的配置）

## 技能配置示例

### 示例1：英雄普通攻击
```
ID: 1001
名称: 战士扇形斩击
类型: 主动技能
触发: 按键/自动
冷却: 1.0秒
前摇: 0.2秒

效果:
- 类型: 伤害
- 攻击方式: 近战
- 范围: 前方扇形（角度120°，半径2米）
- 伤害: 基础攻击力 × 1.0
- 目标数量: 5
```

### 示例2：英雄躲避反击
```
ID: 1002
名称: 躲避反击
类型: 主动技能
触发: 按键
冷却: 8.0秒
前摇: 0.1秒

效果组:
- 效果1: 添加Buff
  - Buff类型: 躲避状态
  - 持续时间: 1.5秒
  - 特殊机制: 受到首次伤害时触发反击并移除状态
  
- 效果2: 条件伤害（躲避成功触发）
  - 攻击方式: 范围伤害
  - 范围: 自身周围圆形（半径3米）
  - 伤害: 基础攻击力 × 1.5
  - 目标数量: 无限
```

### 示例3：英雄大招
```
ID: 1003
名称: 战吼
类型: 主动技能
触发: 按键
冷却: 15.0秒
前摇: 0.3秒

效果组:
- 效果1: 添加Buff（护甲）
  - 属性: 护甲 +50
  - 持续时间: 8秒
  
- 效果2: 添加Buff（攻击力）
  - 属性: 攻击力 +30
  - 持续时间: 8秒
  
- 效果3: 添加Buff（吸血）
  - 特殊效果: 普攻吸血20%
  - 持续时间: 8秒
```

### 示例4：英雄被动技能
```
ID: 1004
名称: 第三击强化
类型: 被动技能
触发: 条件触发（普通攻击第3次）
计数器: 需要

效果组:
- 效果1: 伤害增强
  - 伤害倍率: 1.5倍
  
- 效果2: 生命恢复
  - 回复量: 攻击力 × 0.02
```

### 示例5：滑行技能
```
ID: 9999
名称: 滑行
类型: 主动技能
触发: 按键
冷却: 3.0秒
前摇: 0秒

效果:
- 类型: 移动
- 移动方式: 冲刺
- 方向: 面向方向
- 距离: 5米
- 速度: 瞬间/0.3秒内
- 碰撞: 穿透小怪，被墙挡住
```

### 示例6：Boss大招
```
ID: 2001
名称: 减速光环
类型: 主动技能
触发: AI决策
冷却: 12.0秒
前摇: 0.5秒

效果组:
- 效果1: 范围伤害
  - 范围: 自身周围圆形（半径5米）
  - 伤害: 基础攻击力 × 2.0
  - 目标数量: 无限
  
- 效果2: 添加Debuff
  - Buff类型: 减速
  - 属性: 移动速度 -50%
  - 持续时间: 3秒
  - 范围: 伤害范围内的所有敌人
```

### 示例7：Boss被动
```
ID: 2002
名称: 狂暴
类型: 被动技能
触发: 攻击命中
可叠加: 是
最大层数: 5

效果:
- 类型: 添加Buff（每层独立）
- 属性: 攻击速度 +10%
- 持续时间: 5秒
- 刷新机制: 重新攻击刷新对应层的时间
```

## 实现要点

### 1. 核心类
- **SkillBase**：技能基类
- **SkillEffect**：技能效果基类（可组合多个）
- **SkillConfig**：技能配置（ScriptableObject）

### 2. 效果类型
- **DamageEffect**：伤害效果
- **BuffEffect**：状态效果
- **MovementEffect**：移动效果

### 3. 触发器
- **ManualTrigger**：手动触发（按键）
- **AutoTrigger**：自动触发（AI）
- **ConditionalTrigger**：条件触发（被动技能）

### 4. 目标选择
- **RangeFinder**：范围检测器（扇形/圆形/矩形）
- **TargetSelector**：目标选择器（最近/最远/血量最少等）

## 扩展性

### 添加新技能只需：
1. 配置技能参数（ScriptableObject）
2. 组合现有效果类型
3. 特殊效果才需要写新的SkillEffect子类

### 复杂技能通过组合实现：
- 多段技能：配置多个效果，按顺序执行
- 条件技能：使用条件触发器
- 连携技能：检测状态/计数器

## 总结
- **简洁**：统一的技能框架，效果组合
- **通用**：主动、被动、近战、远程都适用
- **可扩展**：新增效果类型即可支持更多玩法
- **易配置**：ScriptableObject，策划友好