# 城堡系统需求模块

## 概述

城堡是守城游戏的核心防守目标。敌人的最终目标是摧毁城堡，城堡生命值归0时游戏失败。

## 1. 城堡属性

### 1.1 初始属性
- **最大生命值**：1000
- **攻击力**：20
- **攻击速度**：1次/秒
- **攻击范围**：10米
- **防御力**：5

### 1.2 属性说明
- **生命值**：耐久度，归0则游戏失败
- **攻击力**：对敌人造成的基础伤害
- **攻击速度**：攻击频率
- **攻击范围**：能攻击到的半径距离
- **防御力**：减少受到的伤害

## 2. 城堡行为

### 2.1 基础行为
- 固定位置，位于地图中心，不可移动
- 自动攻击范围内的敌人，优先攻击最近的敌人
- 发射炮弹进行远程攻击
- 受到攻击时减少生命值
- 生命值归0时游戏失败

### 2.2 伤害计算
- **攻击伤害**：城堡攻击力 - 敌人防御力
- **受击伤害**：敌人攻击力 - 城堡防御力

## 3. 城堡升级

### 3.1 升级途径

#### 方式1：奖励系统
击杀怪物掉落宝箱，3选1时可能出现：
- 城堡生命 +200
- 城堡攻击力 +30%
- 城堡攻击范围 +3米
- 城堡攻击速度 +20%
- 城堡立即恢复50%生命值

#### 方式2：商店系统
按B键打开强化站，随机4个选项中可能包含：
- 城堡生命（100金币）：最大生命值 +200
- 城堡火力（100金币）：攻击力 +30%
- 城堡恢复（100金币）：立即恢复生命值50%

### 3.2 升级上限
- **生命值**：每次+200，最多5次（最大2000）
- **攻击力**：每次+30%，最多4次
- **攻击速度**：每次+20%，最多3次
- **攻击范围**：每次+3米，最多3次（最大19米）

## 4. 平衡设计

### 4.1 难度曲线
- **前期**：敌人弱，城堡可以轻松守住
- **中期**：敌人变强，玩家需要兼顾城堡和自身
- **后期**：敌人很强，城堡需要升级才能撑住

### 4.2 策略性
- 玩家需要在自身装备升级和城堡升级之间做选择
- 城堡生命值是有限的，玩家需要保护好城堡
- 城堡升级提供防守能力，是后期生存的关键

## 5. UI显示（简要）

- 屏幕顶部显示城堡生命值和血条
- 血条颜色随生命值变化：绿色→黄色→红色
- 生命值<30%时显示警告

## 6. 技术实现（简要）

- 城堡继承实体基类，复用属性和伤害系统
- 使用ScriptableObject配置属性和升级参数
- 城堡死亡与关卡系统联动，触发游戏失败
- 城堡升级集成到奖励系统和商店系统中

